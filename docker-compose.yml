version: '3'

services:
  nginx:
    image: "nginx:latest"
    ports:
      - "8600:80"
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
      - staticfiles:/app/staticfiles
    depends_on:
      - gunicorn
      - daphne

  gunicorn:
    image: "taylorvance/hexachromix:gunicorn-latest"
    environment:
      - "DJANGO_ALLOWED_HOSTS=localhost"
      - "DJANGO_DB_ENGINE=django.db.backends.sqlite3"
      - "DJANGO_DB_NAME=/data/db.sqlite3"
    volumes:
      - hexachromix_data:/data
      - staticfiles:/app/staticfiles

  daphne:
    image: "taylorvance/hexachromix:daphne-latest"
    environment:
      - "DJANGO_ALLOWED_HOSTS=localhost"
      - "DJANGO_DB_ENGINE=django.db.backends.sqlite3"
      - "DJANGO_DB_NAME=/data/db.sqlite3"
    volumes:
      - hexachromix_data:/data

volumes:
  hexachromix_data:
  staticfiles:
